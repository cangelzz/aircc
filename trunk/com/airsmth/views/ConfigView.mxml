<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009" 
    xmlns:s="library://ns.adobe.com/flex/spark"
    viewActivate="init()">
    <s:layout>
        <s:VerticalLayout paddingTop="10"/>
    </s:layout>
    <fx:Script>
        <![CDATA[
            import spark.events.IndexChangeEvent;
            import com.airsmth.defines.*;
            import com.airsmth.views.*;
            public var config:XML;
            
            public function init():void {
                config = Util.getConfig();
                tId.text = config.auth.id;
                tPass.text = config.auth.pass;
                var auto:Number = Number(config.auth.auto);
            }
            
            public function login():void {
                config.auth.id = tId.text;
                config.auth.pass = tPass.text;
                var smth:SMTH = new SMTH();
                smth.input(config);
                smth.addEventListener(LoadEvent.LOGINSTART, onLoginStart);
                smth.addEventListener(LoadEvent.LOGINSUCC, onLoginSucc);
                smth.addEventListener(LoadEvent.LOGINFAIL, onLoginFail);
                smth.login();
            }
            
            private function onLoginStart(event:Event):void {
            }
            
            private function onLoginSucc(event:Event):void {
                if (ckAuto.selected) config.auth.auto = "1";
                else config.auth.auto = "0";
                SMTH.smth.saveConfig(config);
            }
            
            private function onLoginFail(event:Login):void {
            }
            
        ]]>
    </fx:Script>
    <s:navigationContent>
        <s:Button icon="@Embed(source='../../../assets/home.png')" />
    </s:navigationContent>
    <s:Label text="Login"/>
    <s:TextInput id="tId" />
    <s:TextInput id="tPass" displayAsPassword="true" />
    <s:Button label="Save" click="login()" />
    <s:CheckBox label="Auto" id="ckAuto" />
</s:View>